<% unless @dynamic_posts.empty? %>
  $(".dynamic#buffer").html("<%=raw escape_javascript(link_to(pluralize(@dynamic_posts.size.to_s + ' new ', 'open message'), '#', :remote => true, :class => 'post_show')) %>").show();
  $('.post_show').click(function() {
    refreshPosts();
    $(".dynamic#buffer").slideUp();
  });
<% else %>
  refreshPosts();
  $(".memory_post_size").html("<%=raw escape_javascript(pluralize(@interest.memorized_post_content(true,current_user).size.to_s, 'memory')) %>");
<% end %>
  if ($(".activated_post").length > 0) {
    $.getScript("/posts/" + $('.activated_post').attr('data-id') + "/activate.js?indicator=true");
  }
  var loaded_type = $("#catcher").data("load");
  var loader_button = document.getElementById(loaded_type);

  $(".stream_operators").css("background-color","#ccc");
  $(loader_button).css("background-color","#d1ffc0");
  
<% if @most_recent_message %>
  var last_message_time = <%=raw @most_recent_message.created_at.to_i %>;
  $(".lastpost#stamper").attr("data-time",last_message_time);
<% end %>

<% if @message_content.total_pages > 1 && @initial_load == 1 %>
  $(".dynamic#pagedmessages").html("<%=raw escape_javascript(pageless(@message_content.total_pages,('/dynamic_load?iid='+@interest.id.to_s+'&lt='+@load_type))) %>");
<% end %>

// function for refresh of the message contents  
function refreshPosts() {
  $(".dynamic#postcontent").html("<%=raw escape_javascript(render(@message_content)) %>");
  $(".dynamic#memories").html("<%=raw escape_javascript(render(@memorized_content)) %>");
  $(".post_size").html("<%=raw escape_javascript(pluralize(@interest.post_content(current_user).size.to_s, 'open message')) %>");
}
